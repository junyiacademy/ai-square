# Knowledge Graph Technical Specification

> **Related Documents**:
> - [Learning System Spec](./learning-system.md) - Core learning functionality
> - [AI Integration Spec](./ai-integration.md) - AI/MCP integration
> - [Product Requirements](../product-requirements-document.md) - Business requirements

## Overview

æœ¬æ–‡æª”å®šç¾©çŸ¥è­˜åœ–è­œç³»çµ±çš„æŠ€è¡“è¦æ ¼ï¼Œé€™æ˜¯ Phase 4+ (2026+) çš„é€²éšåŠŸèƒ½ã€‚ç³»çµ±å°‡å»ºç«‹åœ¨ç¾æœ‰çš„ AI ç´ é¤Šé ˜åŸŸè¦–è¦ºåŒ–åŸºç¤ä¸Šï¼Œæ¼”é€²æˆæ™ºèƒ½å­¸ç¿’è·¯å¾‘æ¨è–¦ç³»çµ±ã€‚

## ç¾æ³åˆ†æ (Phase 1-2)

### å·²å¯¦ç¾åŠŸèƒ½
- âœ… 4 å€‹ AI ç´ é¤Šé ˜åŸŸçš„è¦–è¦ºåŒ–
- âœ… é ˜åŸŸèˆ‡èƒ½åŠ›çš„é—œè¯å±•ç¤º
- âœ… KSA (Knowledge, Skills, Attitudes) æ˜ å°„
- âœ… åŸºç¤çš„ D3.js è¦–è¦ºåŒ–

### Phase 4+ ç›®æ¨™
- ğŸ¯ å‹•æ…‹å­¸ç¿’è·¯å¾‘ç”Ÿæˆ
- ğŸ¯ å€‹äººåŒ–æ¨è–¦ç³»çµ±
- ğŸ¯ çŸ¥è­˜é»ä¾è³´é—œä¿‚
- ğŸ¯ å­¸ç¿’é€²åº¦é æ¸¬

## 2. è³‡æ–™æ¨¡å‹æ“´å±•

### 2.1 æ¦‚å¿µç¯€é» (ConceptNode)
```typescript
interface ConceptNode {
  id: string;
  type: 'domain' | 'competency' | 'concept' | 'skill' | 'knowledge';
  name: string;
  description: string;
  difficulty: 1 | 2 | 3 | 4 | 5; // é›£åº¦ç­‰ç´š
  estimatedTime: number; // é ä¼°å­¸ç¿’æ™‚é–“ï¼ˆåˆ†é˜ï¼‰
  tags: string[];
  metadata: {
    created: Date;
    updated: Date;
    author: string;
    version: number;
  };
}
```

### 2.2 é—œä¿‚é‚Š (RelationshipEdge)
```typescript
interface RelationshipEdge {
  id: string;
  source: string; // node id
  target: string; // node id
  type: 'prerequisite' | 'related' | 'extends' | 'contrasts';
  strength: number; // 0-1 é—œä¿‚å¼·åº¦
  metadata: {
    description?: string;
    bidirectional: boolean;
  };
}
```

### 2.3 å­¸ç¿’è·¯å¾‘ (LearningPath)
```typescript
interface LearningPath {
  id: string;
  userId: string;
  goal: string; // target competency
  nodes: string[]; // ordered node ids
  progress: {
    completed: string[];
    current: string;
    remaining: string[];
  };
  estimatedTime: number;
  actualTime: number;
  optimizationScore: number; // è·¯å¾‘æœ€å„ªåŒ–åˆ†æ•¸
}
```

## 3. åŠŸèƒ½è¦æ ¼

### 3.1 çŸ¥è­˜é»é—œè¯ç³»çµ±

#### è³‡æ–™çµæ§‹
- **å‰ç½®é—œä¿‚åœ–**ï¼šæœ‰å‘ç„¡ç’°åœ–ï¼ˆDAGï¼‰å„²å­˜å‰ç½®çŸ¥è­˜
- **ç›¸ä¼¼åº¦çŸ©é™£**ï¼šè¨ˆç®—æ¦‚å¿µé–“çš„ç›¸ä¼¼åº¦ï¼ˆ0-1ï¼‰
- **é›£åº¦æ¢¯åº¦**ï¼šè‡ªå‹•è¨ˆç®—å­¸ç¿’æ›²ç·š

#### API ç«¯é»
```typescript
// ç²å–æ¦‚å¿µé—œè¯
GET /api/knowledge-graph/concept/:id/relations
Response: {
  prerequisites: ConceptNode[]
  related: ConceptNode[]
  extensions: ConceptNode[]
}

// è¨ˆç®—æ¦‚å¿µè·¯å¾‘
POST /api/knowledge-graph/path
Body: { from: string, to: string, userId?: string }
Response: {
  paths: LearningPath[]
  recommended: LearningPath
}
```

### 3.2 å­¸ç¿’è·¯å¾‘å„ªåŒ–

#### æ¼”ç®—æ³•
1. **Dijkstra æœ€çŸ­è·¯å¾‘**ï¼šåŸºæ–¼æ™‚é–“æˆæœ¬
2. **A* å•Ÿç™¼å¼æœå°‹**ï¼šè€ƒæ…®å€‹äººå­¸ç¿’é¢¨æ ¼
3. **å¼·åŒ–å­¸ç¿’**ï¼šåŸºæ–¼æ­·å²æ•¸æ“šå„ªåŒ–

#### å„ªåŒ–å› ç´ 
- å­¸ç¿’æ™‚é–“æœ€å°åŒ–
- é›£åº¦æ¢¯åº¦å¹³æ»‘
- èˆˆè¶£åŒ¹é…åº¦
- å‰ç½®çŸ¥è­˜è¦†è“‹

### 3.3 æ¦‚å¿µè¦–è¦ºåŒ–

#### è¦–åœ–æ¨¡å¼
1. **å±¤ç´šè¦–åœ–**ï¼ˆHierarchicalï¼‰
   ```
   Domain
     â”œâ”€â”€ Competency 1
     â”‚   â”œâ”€â”€ Concept 1.1
     â”‚   â””â”€â”€ Concept 1.2
     â””â”€â”€ Competency 2
   ```

2. **ç¶²çµ¡è¦–åœ–**ï¼ˆNetworkï¼‰
   - Force-directed layout
   - ç¯€é»å¤§å° = é‡è¦æ€§
   - é‚Šç²—ç´° = é—œä¿‚å¼·åº¦

3. **æ™‚é–“è»¸è¦–åœ–**ï¼ˆTimelineï¼‰
   - Xè»¸ï¼šæ™‚é–“é€²åº¦
   - Yè»¸ï¼šé›£åº¦å±¤ç´š
   - é¡¯ç¤ºå­¸ç¿’é †åº

#### äº’å‹•åŠŸèƒ½
- ç¯€é»å±•é–‹/æ”¶åˆ
- è·¯å¾‘é«˜äº®
- ç¯©é¸å™¨ï¼ˆé›£åº¦ã€é¡å‹ã€ç‹€æ…‹ï¼‰
- æœå°‹åŠŸèƒ½
- åŒ¯å‡ºåŠŸèƒ½ï¼ˆPNGã€SVGã€JSONï¼‰

### 3.4 æ™ºèƒ½æ¨è–¦å¼•æ“

#### æ¨è–¦ç­–ç•¥
1. **å”åŒéæ¿¾**ï¼šåŸºæ–¼ç›¸ä¼¼ç”¨æˆ¶çš„å­¸ç¿’è·¯å¾‘
2. **å…§å®¹éæ¿¾**ï¼šåŸºæ–¼æ¦‚å¿µç›¸ä¼¼åº¦
3. **æ··åˆæ¨è–¦**ï¼šçµåˆå¤šç¨®ç­–ç•¥

#### æ¨è–¦ API
```typescript
GET /api/knowledge-graph/recommendations
Query: {
  userId: string
  type: 'next' | 'path' | 'review'
  limit: number
}
Response: {
  recommendations: {
    node: ConceptNode
    reason: string
    score: number
  }[]
}
```

## 4. æŠ€è¡“æ¶æ§‹

### 4.1 å¾Œç«¯æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Graph Database (Neo4j)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Graph Processing Service      â”‚
â”‚  (NetworkX / Graph Algorithms)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Recommendation Engine       â”‚
â”‚    (TensorFlow / Scikit-learn)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         FastAPI REST API         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å‰ç«¯æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Graph Visualization Layer     â”‚
â”‚  (D3.js / Cytoscape.js / Sigma) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     State Management (Zustand)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Graph Utilities Library       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. Implementation Roadmap

### Phase 4 Prerequisites (2025)
**å¿…é ˆå…ˆå®Œæˆ**:
- âœ… ç©©å®šçš„å­¸ç¿’å¹³å°
- âœ… è±å¯Œçš„å…§å®¹åº«
- âœ… ç”¨æˆ¶å­¸ç¿’æ•¸æ“šç´¯ç©
- âœ… åŸºç¤ AI æ•´åˆ

### Phase 4: Basic Knowledge Graph (2026 Q1-Q2)
**ç›®æ¨™**: å»ºç«‹çŸ¥è­˜é—œè¯åŸºç¤

#### åŠŸèƒ½å¯¦ä½œ
- [ ] çŸ¥è­˜é»ä¾è³´é—œä¿‚å®šç¾©
- [ ] åŸºç¤è·¯å¾‘è¨ˆç®—ï¼ˆæœ€çŸ­è·¯å¾‘ï¼‰
- [ ] è¦–è¦ºåŒ–å¢å¼·ï¼ˆé¡¯ç¤ºé—œè¯ï¼‰
- [ ] æ‰‹å‹•è·¯å¾‘ç·¨è¼¯

#### æŠ€è¡“éœ€æ±‚
- PostgreSQL åœ–æ“´å±•ï¼ˆåˆæœŸï¼‰
- D3.js åŠ›å°å‘åœ–
- è·¯å¾‘æ¼”ç®—æ³•å¯¦ä½œ

**æˆæœ¬å½±éŸ¿**: åŒ…å«åœ¨ Phase 4 åŸºç¤è¨­æ–½å…§

### Phase 4+: Smart Learning Paths (2026 Q3-Q4)
**ç›®æ¨™**: å€‹äººåŒ–å­¸ç¿’è·¯å¾‘

#### åŠŸèƒ½å¯¦ä½œ
- [ ] AI é©…å‹•è·¯å¾‘æ¨è–¦
- [ ] å­¸ç¿’é¢¨æ ¼åˆ†æ
- [ ] é€²åº¦é æ¸¬æ¨¡å‹
- [ ] é©æ‡‰æ€§èª¿æ•´

#### æŠ€è¡“éœ€æ±‚
- Neo4j åœ–è³‡æ–™åº«ï¼ˆé¸ç”¨ï¼‰
- æ©Ÿå™¨å­¸ç¿’æ¨¡å‹
- å³æ™‚æ¨è–¦å¼•æ“

**æˆæœ¬å½±éŸ¿**: 
- Neo4j: ~$200/æœˆ
- ML é‹ç®—: ~$100/æœˆ

### Phase 5: Advanced Analytics (2027+)
**ç›®æ¨™**: ä¼æ¥­ç´šå­¸ç¿’åˆ†æ

#### åŠŸèƒ½å¯¦ä½œ
- [ ] çµ„ç¹”çŸ¥è­˜åœ–è­œ
- [ ] æŠ€èƒ½å·®è·åˆ†æ
- [ ] åœ˜éšŠå­¸ç¿’è·¯å¾‘
- [ ] é æ¸¬æ€§åˆ†æ

#### æŠ€è¡“éœ€æ±‚
- å¤§è¦æ¨¡åœ–è™•ç†
- åˆ†æ•£å¼è¨ˆç®—
- å³æ™‚åˆ†æå¼•æ“

**æˆæœ¬å½±éŸ¿**: ä¼æ¥­ç´šå®šåƒ¹

## 6. æˆåŠŸæŒ‡æ¨™

### æŠ€è¡“æŒ‡æ¨™
- åœ–æŸ¥è©¢éŸ¿æ‡‰æ™‚é–“ < 100ms
- è·¯å¾‘è¨ˆç®—æ™‚é–“ < 500ms
- æ”¯æ´ 10,000+ ç¯€é»è¦æ¨¡

### æ¥­å‹™æŒ‡æ¨™
- å­¸ç¿’è·¯å¾‘å®Œæˆç‡æå‡ 30%
- å¹³å‡å­¸ç¿’æ™‚é–“æ¸›å°‘ 20%
- ç”¨æˆ¶æ»¿æ„åº¦ > 4.5/5

## 7. é¢¨éšªèˆ‡ç·©è§£

### æŠ€è¡“é¢¨éšª
1. **åœ–è³‡æ–™åº«æ•ˆèƒ½**
   - ç·©è§£ï¼šä½¿ç”¨å¿«å–ã€é è¨ˆç®—å¸¸ç”¨è·¯å¾‘

2. **è¦–è¦ºåŒ–æ•ˆèƒ½**
   - ç·©è§£ï¼šè™›æ“¬åŒ–æ¸²æŸ“ã€WebGL åŠ é€Ÿ

3. **æ¨è–¦æº–ç¢ºæ€§**
   - ç·©è§£ï¼šæŒçºŒæ”¶é›†åé¥‹ã€æ¨¡å‹è¿­ä»£

### æ¥­å‹™é¢¨éšª
1. **å…§å®¹å“è³ª**
   - ç·©è§£ï¼šå°ˆå®¶å¯©æ ¸ã€ç¤¾ç¾¤è²¢ç»

2. **ç”¨æˆ¶æ¡ç”¨åº¦**
   - ç·©è§£ï¼šæ¼¸é€²å¼æ¨å‡ºã€ç”¨æˆ¶æ•™è‚²

## 8. æŠ€è¡“è€ƒé‡

### ç‚ºä»€éº¼åœ¨ Phase 4ï¼Ÿ
1. **éœ€è¦æ•¸æ“šç´¯ç©**: æœ‰æ•ˆçš„æ¨è–¦éœ€è¦è¶³å¤ çš„å­¸ç¿’æ•¸æ“š
2. **å…§å®¹æˆç†Ÿåº¦**: éœ€è¦å®Œæ•´çš„å…§å®¹é—œè¯å®šç¾©
3. **æŠ€è¡“è¤‡é›œåº¦**: åœ–è³‡æ–™åº«å’Œ ML å¢åŠ ç³»çµ±è¤‡é›œåº¦
4. **æˆæœ¬è€ƒé‡**: åœ–è³‡æ–™åº«å’Œé‹ç®—è³‡æºæˆæœ¬è¼ƒé«˜

### æ¼¸é€²å¼å¯¦ä½œç­–ç•¥
1. **Phase 1-3**: ä½¿ç”¨ç¾æœ‰è¦–è¦ºåŒ–ï¼Œæ”¶é›†ä½¿ç”¨æ•¸æ“š
2. **Phase 4 åˆæœŸ**: PostgreSQL + ç°¡å–®æ¼”ç®—æ³•
3. **Phase 4 ä¸­æœŸ**: è©•ä¼°æ˜¯å¦éœ€è¦å°ˆç”¨åœ–è³‡æ–™åº«
4. **Phase 5**: ä¼æ¥­ç´šåœ–åˆ†æå¹³å°

### æŠ€è¡“é¸å‹è€ƒé‡
- **PostgreSQL vs Neo4j**: åˆæœŸç”¨ PostgreSQL è¶³å¤ ï¼Œè¦æ¨¡å¤§æ™‚å†é·ç§»
- **D3.js vs WebGL**: ç¯€é»æ•¸ < 1000 ç”¨ D3.jsï¼Œæ›´å¤šå‰‡éœ€ WebGL
- **æ¼”ç®—æ³•é¸æ“‡**: å¾ç°¡å–®é–‹å§‹ï¼Œæ ¹æ“šæ•ˆæœé€æ­¥å„ªåŒ–

## çµè«–

çŸ¥è­˜åœ–è­œç³»çµ±æ˜¯ AI Square çš„é•·æœŸé¡˜æ™¯åŠŸèƒ½ï¼Œå°‡åœ¨å¹³å°æˆç†Ÿå¾Œï¼ˆPhase 4+ï¼‰å¯¦æ–½ã€‚é€éæ¼¸é€²å¼é–‹ç™¼ç­–ç•¥ï¼Œæˆ‘å€‘å¯ä»¥åœ¨æ§åˆ¶æˆæœ¬å’Œè¤‡é›œåº¦çš„åŒæ™‚ï¼Œç‚ºç”¨æˆ¶æä¾›è¶Šä¾†è¶Šæ™ºèƒ½çš„å­¸ç¿’é«”é©—ã€‚