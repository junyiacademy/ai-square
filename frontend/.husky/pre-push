#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

cd frontend

echo "ğŸ” Running TypeScript checks..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript errors found. Please fix before pushing."
  exit 1
fi

echo "ğŸ“‹ Running ESLint..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ESLint errors found. Please fix before pushing."
  exit 1
fi

# Optional: Run comprehensive checks with --full flag
if [ "$1" = "--full" ]; then
  echo "ğŸ§ª Running unit tests..."
  npm run test:unit
  if [ $? -ne 0 ]; then
    echo "âŒ Unit tests failed. Please fix before pushing."
    exit 1
  fi
  
  echo "ğŸ—ï¸ Running build check..."
  npm run build
  if [ $? -ne 0 ]; then
    echo "âŒ Build failed. Please fix before pushing."
    exit 1
  fi
else
  echo "ğŸ’¡ Tip: Use 'git push --no-verify' to skip checks (not recommended)"
  echo "ğŸ’¡ Or run full checks with: git push --full"
fi

echo "âœ… All checks passed! Pushing to remote..."