#!/usr/bin/env node
/**
 * 簡單的翻譯填充腳本
 * 專注於繁體中文轉簡體中文
 */

const fs = require('fs');
const path = require('path');

// 繁體轉簡體映射表
const T2S_MAP = {
  '系統': '系统',
  '演算法': '算法',
  '資料': '数据',
  '處理': '处理',
  '產生': '产生',
  '輸出': '输出',
  '輸入': '输入',
  '學習': '学习',
  '應用': '应用',
  '開發': '开发',
  '訓練': '训练',
  '實施': '实施',
  '優化': '优化',
  '決策': '决策',
  '預測': '预测',
  '評估': '评估',
  '設計': '设计',
  '環境': '环境',
  '虛擬': '虚拟',
  '實體': '实体',
  '語言': '语言',
  '綜合': '综合',
  '階段': '阶段',
  '組件': '组件',
  '硬體': '硬件',
  '軟體': '软件',
  '介面': '接口',
  '架構': '架构',
  '權重': '权重',
  '偏差': '偏差',
  '偵測': '检测',
  '模式': '模式',
  '統計': '统计',
  '推論': '推理',
  '機器': '机器',
  '響應': '响应',
  '接收': '接收',
  '部署': '部署',
  '適應': '适应',
  '自主': '自主',
  '實現': '实现',
  '認識': '认识',
  '標準': '标准',
  '類型': '类型',
  '過程': '过程',
  '機制': '机制',
  '邏輯': '逻辑',
  '結構': '结构',
  '層級': '层级',
  '複雜': '复杂',
  '簡單': '简单',
  '動態': '动态',
  '靜態': '静态',
  '連接': '连接',
  '網絡': '网络',
  '節點': '节点',
  '邊緣': '边缘',
  '中心': '中心',
  '分散': '分散',
  '集中': '集中',
  '協作': '协作',
  '獨立': '独立',
  '並行': '并行',
  '序列': '序列',
  '記憶': '记忆',
  '存儲': '存储',
  '檢索': '检索',
  '搜尋': '搜索',
  '匹配': '匹配',
  '比較': '比较',
  '分析': '分析',
  '診斷': '诊断',
  '監控': '监控',
  '調整': '调整',
  '校準': '校准',
  '驗證': '验证',
  '確認': '确认',
  '測試': '测试',
  '實驗': '实验',
  '觀察': '观察',
  '記錄': '记录',
  '報告': '报告',
  '文檔': '文档',
  '規範': '规范',
  '標準化': '标准化',
  '統一': '统一',
  '整合': '整合',
  '分離': '分离',
  '模組': '模块',
  '功能': '功能',
  '性能': '性能',
  '效率': '效率',
  '質量': '质量',
  '精確': '精确',
  '準確': '准确',
  '可靠': '可靠',
  '穩定': '稳定',
  '安全': '安全',
  '保護': '保护',
  '加密': '加密',
  '解密': '解密',
  '授權': '授权',
  '認證': '认证',
  '許可': '许可',
  '限制': '限制',
  '控制': '控制',
  '管理': '管理',
  '維護': '维护',
  '更新': '更新',
  '升級': '升级',
  '遷移': '迁移',
  '備份': '备份',
  '恢復': '恢复',
  '同步': '同步',
  '異步': '异步',
  '即時': '即时',
  '延遲': '延迟',
  '緩存': '缓存',
  '隊列': '队列',
  '堆疊': '堆栈',
  '樹狀': '树状',
  '圖形': '图形',
  '線性': '线性',
  '非線性': '非线性',
  '遞歸': '递归',
  '迭代': '迭代',
  '循環': '循环',
  '條件': '条件',
  '邏輯': '逻辑',
  '運算': '运算',
  '計算': '计算',
  '處理器': '处理器',
  '記憶體': '内存',
  '儲存': '存储',
  '傳輸': '传输',
  '通訊': '通信',
  '協議': '协议',
  '標準': '标准',
  '規則': '规则',
  '策略': '策略',
  '方案': '方案',
  '解決': '解决',
  '問題': '问题',
  '挑戰': '挑战',
  '機會': '机会',
  '風險': '风险',
  '評估': '评估',
  '分析': '分析',
  '預測': '预测',
  '計劃': '计划',
  '執行': '执行',
  '監督': '监督',
  '回饋': '反馈',
  '改進': '改进',
  '優化': '优化',
  '創新': '创新',
  '研發': '研发',
  '實驗': '实验',
  '原型': '原型',
  '產品': '产品',
  '服務': '服务',
  '用戶': '用户',
  '客戶': '客户',
  '市場': '市场',
  '競爭': '竞争',
  '合作': '合作',
  '夥伴': '伙伴',
  '團隊': '团队',
  '組織': '组织',
  '企業': '企业',
  '產業': '产业',
  '領域': '领域',
  '專業': '专业',
  '技術': '技术',
  '科學': '科学',
  '研究': '研究',
  '理論': '理论',
  '實踐': '实践',
  '應用': '应用',
  '案例': '案例',
  '範例': '范例',
  '模型': '模型',
  '框架': '框架',
  '平台': '平台',
  '工具': '工具',
  '資源': '资源',
  '資產': '资产',
  '價值': '价值',
  '效益': '效益',
  '成本': '成本',
  '投資': '投资',
  '回報': '回报',
  '績效': '绩效',
  '指標': '指标',
  '數據': '数据',
  '資訊': '信息',
  '知識': '知识',
  '智慧': '智慧',
  '經驗': '经验',
  '技能': '技能',
  '能力': '能力',
  '素養': '素养',
  '態度': '态度',
  '行為': '行为',
  '習慣': '习惯',
  '文化': '文化',
  '倫理': '伦理',
  '道德': '道德',
  '責任': '责任',
  '義務': '义务',
  '權利': '权利',
  '自由': '自由',
  '平等': '平等',
  '公平': '公平',
  '正義': '正义',
  '透明': '透明',
  '開放': '开放',
  '參與': '参与',
  '溝通': '沟通',
  '對話': '对话',
  '討論': '讨论',
  '辯論': '辩论',
  '決議': '决议',
  '共識': '共识',
  '協商': '协商',
  '談判': '谈判',
  '合約': '合约',
  '協議': '协议',
  '條款': '条款',
  '規定': '规定',
  '法律': '法律',
  '法規': '法规',
  '政策': '政策',
  '制度': '制度',
  '機制': '机制',
  '程序': '程序',
  '流程': '流程',
  '步驟': '步骤',
  '方法': '方法',
  '技巧': '技巧',
  '策略': '策略',
  '戰略': '战略',
  '戰術': '战术',
  '計畫': '计划',
  '專案': '项目',
  '任務': '任务',
  '目標': '目标',
  '願景': '愿景',
  '使命': '使命',
  '價值觀': '价值观',
  '原則': '原则',
  '信念': '信念',
  '理念': '理念',
  '哲學': '哲学',
  '思想': '思想',
  '概念': '概念',
  '定義': '定义',
  '術語': '术语',
  '詞彙': '词汇',
  '語言': '语言',
  '表達': '表达',
  '描述': '描述',
  '說明': '说明',
  '解釋': '解释',
  '闡述': '阐述',
  '論述': '论述',
  '論證': '论证',
  '證明': '证明',
  '驗證': '验证',
  '確認': '确认',
  '核實': '核实',
  '審查': '审查',
  '審核': '审核',
  '批准': '批准',
  '授權': '授权',
  '委託': '委托',
  '代理': '代理',
  '代表': '代表',
  '負責': '负责',
  '管理': '管理',
  '監督': '监督',
  '指導': '指导',
  '輔導': '辅导',
  '培訓': '培训',
  '教育': '教育',
  '學習': '学习',
  '研習': '研习',
  '進修': '进修',
  '發展': '发展',
  '成長': '成长',
  '進步': '进步',
  '提升': '提升',
  '改善': '改善',
  '增強': '增强',
  '擴展': '扩展',
  '延伸': '延伸',
  '深化': '深化',
  '細化': '细化',
  '具體': '具体',
  '抽象': '抽象',
  '概括': '概括',
  '總結': '总结',
  '歸納': '归纳',
  '演繹': '演绎',
  '推理': '推理',
  '判斷': '判断',
  '評價': '评价',
  '評分': '评分',
  '排名': '排名',
  '分類': '分类',
  '歸類': '归类',
  '整理': '整理',
  '組織': '组织',
  '安排': '安排',
  '配置': '配置',
  '調配': '调配',
  '分配': '分配',
  '指派': '指派',
  '委派': '委派',
  '授權': '授权',
  '賦能': '赋能',
  '激勵': '激励',
  '鼓勵': '鼓励',
  '支持': '支持',
  '協助': '协助',
  '幫助': '帮助',
  '服務': '服务',
  '提供': '提供',
  '供應': '供应',
  '交付': '交付',
  '傳遞': '传递',
  '傳播': '传播',
  '擴散': '扩散',
  '影響': '影响',
  '作用': '作用',
  '功能': '功能',
  '效果': '效果',
  '結果': '结果',
  '成果': '成果',
  '產出': '产出',
  '輸出': '输出',
  '呈現': '呈现',
  '展示': '展示',
  '顯示': '显示',
  '表現': '表现',
  '體現': '体现',
  '反映': '反映',
  '代表': '代表',
  '象徵': '象征',
  '意義': '意义',
  '涵義': '含义',
  '內涵': '内涵',
  '外延': '外延',
  '範圍': '范围',
  '邊界': '边界',
  '限度': '限度',
  '程度': '程度',
  '水準': '水准',
  '層次': '层次',
  '等級': '等级',
  '級別': '级别',
  '類別': '类别',
  '種類': '种类',
  '形式': '形式',
  '方式': '方式',
  '途徑': '途径',
  '管道': '渠道',
  '媒介': '媒介',
  '載體': '载体',
  '平臺': '平台',
  '基礎': '基础',
  '根本': '根本',
  '核心': '核心',
  '關鍵': '关键',
  '重點': '重点',
  '焦點': '焦点',
  '中心': '中心',
  '主體': '主体',
  '客體': '客体',
  '對象': '对象',
  '目的': '目的',
  '宗旨': '宗旨',
  '方針': '方针',
  '政策': '政策',
  '措施': '措施',
  '辦法': '办法',
  '方案': '方案',
  '計劃': '计划',
  '規劃': '规划',
  '設計': '设计',
  '構思': '构思',
  '創意': '创意',
  '創新': '创新',
  '發明': '发明',
  '發現': '发现',
  '探索': '探索',
  '研究': '研究',
  '調查': '调查',
  '分析': '分析',
  '綜合': '综合',
  '整合': '整合',
  '融合': '融合',
  '結合': '结合',
  '聯合': '联合',
  '合併': '合并',
  '統一': '统一',
  '一致': '一致',
  '協調': '协调',
  '配合': '配合',
  '適應': '适应',
  '調整': '调整',
  '修正': '修正',
  '修改': '修改',
  '更改': '更改',
  '變更': '变更',
  '轉變': '转变',
  '轉化': '转化',
  '轉型': '转型',
  '升級': '升级',
  '進化': '进化',
  '演化': '演化',
  '發展': '发展',
  '擴大': '扩大',
  '縮小': '缩小',
  '增加': '增加',
  '減少': '减少',
  '提高': '提高',
  '降低': '降低',
  '加強': '加强',
  '減弱': '减弱',
  '鞏固': '巩固',
  '穩固': '稳固',
  '強化': '强化',
  '優化': '优化',
  '簡化': '简化',
  '複雜化': '复杂化',
  '標準化': '标准化',
  '規範化': '规范化',
  '制度化': '制度化',
  '系統化': '系统化',
  '科學化': '科学化',
  '現代化': '现代化',
  '信息化': '信息化',
  '數字化': '数字化',
  '智能化': '智能化',
  '自動化': '自动化',
  '機械化': '机械化',
  '電子化': '电子化',
  '網絡化': '网络化',
  '全球化': '全球化',
  '本地化': '本地化',
  '個性化': '个性化',
  '定製化': '定制化',
  '專業化': '专业化',
  '職業化': '职业化',
  '商業化': '商业化',
  '產業化': '产业化',
  '規模化': '规模化',
  '集約化': '集约化',
  '精細化': '精细化',
  '精準化': '精准化'
};

function convertTraditionalToSimplified(text) {
  let result = text;
  
  // 按照詞語長度從長到短排序，避免部分替換問題
  const sortedEntries = Object.entries(T2S_MAP).sort((a, b) => b[0].length - a[0].length);
  
  for (const [trad, simp] of sortedEntries) {
    result = result.replace(new RegExp(trad, 'g'), simp);
  }
  
  return result;
}

async function fillTranslations() {
  console.log('📝 填充簡體中文翻譯...\n');
  
  const jsonPath = path.join(__dirname, '../public/rubrics_data_json/ksa_codes.json');
  const data = JSON.parse(fs.readFileSync(jsonPath, 'utf-8'));
  
  let count = 0;
  
  // 處理所有 sections
  ['knowledge_codes', 'skill_codes', 'attitude_codes'].forEach(section => {
    if (!data[section]) return;
    
    Object.values(data[section].themes).forEach(theme => {
      Object.values(theme.codes).forEach(code => {
        // 如果有繁體中文且簡體中文需要翻譯
        if (code.summary_zhTW && code.summary_zhCN?.includes('translation needed')) {
          code.summary_zhCN = convertTraditionalToSimplified(code.summary_zhTW);
          count++;
        }
      });
    });
  });
  
  // 保存
  fs.writeFileSync(jsonPath, JSON.stringify(data, null, 2));
  console.log(`✅ 已轉換 ${count} 個簡體中文翻譯\n`);
  
  // 同步到 YAML
  console.log('🔄 同步到 YAML...');
  const { exec } = require('child_process');
  exec('node scripts/yaml-json-crud-system.js sync rubrics ksa_codes', (error) => {
    if (error) {
      console.error('❌ 同步失敗:', error.message);
    } else {
      console.log('✅ 同步完成');
    }
  });
}

fillTranslations();